<!DOCTYPE html>
<html>
<head>
    <title>–í—Ö–æ–¥ - MySocialNet</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="auth-container">
        <div class="auth-header">
            <h1>üê¨ MySocialNet</h1>
            <p>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –Ω–∞—à–µ–º—É —Å–æ–æ–±—â–µ—Å—Ç–≤—É!</p>
        </div>

        <div class="auth-form">
            <h2>üîê –í—Ö–æ–¥ –≤ –∞–∫–∫–∞—É–Ω—Ç</h2>
            
            <!-- –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ -->
            <div style="background: #e8f5e8; padding: 10px; border-radius: 8px; margin-bottom: 15px; font-size: 14px;">
                <strong>–¢–µ—Å—Ç–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç:</strong><br>
                –õ–æ–≥–∏–Ω: test<br>
                –ü–∞—Ä–æ–ª—å: test
            </div>
            
            <form id="loginForm">
                <input type="text" id="username" placeholder="üë§ –í–∞—à username" required>
                <input type="password" id="password" placeholder="üîí –í–∞—à –ø–∞—Ä–æ–ª—å" required>
                <button type="submit" class="btn btn-large">üöÄ –í–æ–π—Ç–∏</button>
            </form>

            <div class="auth-features">
                <div class="feature">‚úÖ –ï–¥–∏–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</div>
                <div class="feature">üí¨ –†–µ–∞–ª—å–Ω—ã–µ –ø–æ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö</div>
                <div class="feature">üë• –ù–∞—Å—Ç–æ—è—â–∏–µ –¥—Ä—É–∑—å—è</div>
                <div class="feature">üì± Supabase powered</div>
            </div>

            <div class="auth-links">
                <a href="register.html">üìù –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</a>
                <a href="#" onclick="showForgotPassword()">üîê –ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</a>
            </div>
        </div>
    </div>

    <script type="module">
        import { loginUser, checkConnection } from './supabase.js'

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', async function() {
            const isConnected = await checkConnection()
            if (!isConnected) {
                alert('‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.')
            }
        })

        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault()
            
            const username = document.getElementById('username').value.trim()
            const password = document.getElementById('password').value
            
            if (!username || !password) {
                alert('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!')
                return
            }
            
            const button = e.target.querySelector('button')
            const originalText = button.textContent
            button.textContent = '‚è≥ –í—Ö–æ–¥...'
            button.disabled = true
            
            try {
                console.log('–ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤—Ö–æ–¥–∞...')
                const user = await loginUser(username, password)
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
                localStorage.setItem('currentUser', user.username)
                
                console.log('–í—Ö–æ–¥ —É—Å–ø–µ—à–µ–Ω, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ...')
                alert('‚úÖ –í—Ö–æ–¥ —É—Å–ø–µ—à–µ–Ω!')
                window.location.href = 'index.html'
                
            } catch (error) {
                console.error('–§–∏–Ω–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error)
                alert('‚ùå ' + error.message)
            } finally {
                button.textContent = originalText
                button.disabled = false
            }
        })

        function showForgotPassword() {
            alert('üîê –§—É–Ω–∫—Ü–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏!')
        }
    </script>
</body>
</html>
