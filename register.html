<!DOCTYPE html>
<html>
<head>
    <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è - MySocialNet</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="auth-container">
        <div class="auth-header">
            <h1>üê¨ MySocialNet</h1>
            <p>–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç –≤—Å–µ–≥–æ –∑–∞ –º–∏–Ω—É—Ç—É!</p>
        </div>

        <div class="auth-form">
            <h2>üéâ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
            <form id="registerForm">
                <input type="text" id="username" placeholder="üë§ –ü—Ä–∏–¥—É–º–∞–π—Ç–µ –Ω–∏–∫" required>
                <input type="password" id="password" placeholder="üîí –ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                <input type="password" id="confirmPassword" placeholder="üîí –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                <button type="submit" class="btn btn-large">üöÄ –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
            </form>

            <div class="password-requirements">
                <h4>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–∞—Ä–æ–ª—é:</h4>
                <div class="requirement">‚úÖ –ù–µ –º–µ–Ω–µ–µ 4 —Å–∏–º–≤–æ–ª–æ–≤</div>
                <div class="requirement">‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–∏–∫</div>
                <div class="requirement">‚úÖ –ë–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤</div>
            </div>

            <div class="auth-links">
                <a href="login.html">üîê –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –í–æ–π—Ç–∏</a>
            </div>
        </div>
    </div>

    <script>
        function getLocalDB() {
            const db = localStorage.getItem('social_network_db');
            return db ? JSON.parse(db) : { users: [], posts: [], comments: [], friends: [], messages: [] };
        }

        function saveLocalDB(db) {
            localStorage.setItem('social_network_db', JSON.stringify(db));
        }

        async function syncWithGitHub() {
            try {
                const response = await fetch('https://raw.githubusercontent.com/–í–ê–®_–ù–ò–ö/my-social-network/main/database.json?t=' + Date.now());
                const githubDB = await response.json();
                const localDB = getLocalDB();
                
                const mergedDB = {
                    users: [...new Map([...localDB.users, ...githubDB.users].map(user => [user.username, user])).values()],
                    posts: [...new Map([...localDB.posts, ...githubDB.posts].map(post => [post.id, post])).values()],
                    comments: [...new Map([...localDB.comments, ...githubDB.comments].map(comment => [comment.id, comment])).values()],
                    friends: [...new Map([...localDB.friends, ...githubDB.friends].map(friend => [friend.id, friend])).values()],
                    messages: [...new Map([...localDB.messages, ...githubDB.messages].map(msg => [msg.id, msg])).values()]
                };
                
                saveLocalDB(mergedDB);
                return mergedDB;
            } catch (error) {
                return getLocalDB();
            }
        }

        let database = { users: [], posts: [], comments: [], friends: [], messages: [] };

        async function loadDatabase() {
            database = await syncWithGitHub();
        }

        function isUsernameTaken(username) {
            return database.users.some(user => user.username === username);
        }

        document.getElementById('registerForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            await loadDatabase();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (username.length < 3) {
                alert('‚ùå –ù–∏–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—åËá≥Â∞ë 3 —Å–∏–º–≤–æ–ª–∞!');
                return;
            }
            
            if (password.length < 4) {
                alert('‚ùå –ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—åËá≥Â∞ë 4 —Å–∏–º–≤–æ–ª–∞!');
                return;
            }
            
            if (password !== confirmPassword) {
                alert('‚ùå –ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!');
                return;
            }
            
            if (isUsernameTaken(username)) {
                alert('‚ùå –≠—Ç–æ—Ç –Ω–∏–∫ —É–∂–µ –∑–∞–Ω—è—Ç! –ü—Ä–∏–¥—É–º–∞–π—Ç–µ –¥—Ä—É–≥–æ–π.');
                return;
            }
            
            // –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const newUser = {
                username: username,
                password: password,
                joined: new Date().toISOString(),
                bio: '',
                city: '',
                birthday: ''
            };
            
            database.users.push(newUser);
            saveLocalDB(database);
            
            alert('üéâ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç.');
            window.location.href = 'login.html';
        });

        loadDatabase();
    </script>

    <style>
        .password-requirements {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: left;
        }
        .password-requirements h4 {
            margin-top: 0;
            color: #764ba2;
        }
        .requirement {
            margin: 5px 0;
            font-size: 14px;
        }
    </style>
</body>
</html>