<!-- В register.html заменить только script тег -->
<script src="./supabase.js"></script>
<script>
    document.getElementById('registerForm').addEventListener('submit', async function(e) {
        e.preventDefault()
        
        const username = document.getElementById('username').value.trim()
        const password = document.getElementById('password').value
        const confirmPassword = document.getElementById('confirmPassword').value
        
        if (username.length < 3) {
            alert('❌ Username должен быть至少 3 символа!')
            return
        }
        
        if (password.length < 1) {
            alert('❌ Введите пароль!')
            return
        }
        
        if (password !== confirmPassword) {
            alert('❌ Пароли не совпадают!')
            return
        }
        
        const button = e.target.querySelector('button')
        const originalText = button.textContent
        button.textContent = '⏳ Регистрация...'
        button.disabled = true
        
        try {
            await window.supabaseAPI.registerUser(username, password)
            alert('🎉 Регистрация успешна! Теперь вы можете войти в аккаунт.')
            window.location.href = 'login.html'
        } catch (error) {
            alert('❌ ' + error.message)
        } finally {
            button.textContent = originalText
            button.disabled = false
        }
    })
</script>
